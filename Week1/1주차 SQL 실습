{"cells":[{"cell_type":"markdown","source":["#### 과제 확인\n","- [MAU 세보기](#scrollTo=o3VMzxkp6l50)"],"metadata":{"id":"T3kMzUOk-j3c"}},{"cell_type":"markdown","metadata":{"id":"EVuF1_D9zWBV"},"source":["# 주피터 SQL 엔진 설정"]},{"cell_type":"code","execution_count":1,"metadata":{"id":"wOS9-QY1amnt","executionInfo":{"status":"ok","timestamp":1663474402831,"user_tz":-540,"elapsed":317,"user":{"displayName":"DeepFlame","userId":"10126863241255225736"}}},"outputs":[],"source":["%load_ext sql"]},{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":35},"id":"XehcNor8a-za","outputId":"239ee9ca-c2d9-45a3-c308-68f415febe13","executionInfo":{"status":"ok","timestamp":1663474405783,"user_tz":-540,"elapsed":2953,"user":{"displayName":"DeepFlame","userId":"10126863241255225736"}}},"outputs":[{"output_type":"execute_result","data":{"text/plain":["'Connected: guest@dev'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":2}],"source":["# ID와 PW를 자신의 환경에 맞게 수정\n","%sql postgresql://guest:Guest1234@learnde.cduaw970ssvt.ap-northeast-2.redshift.amazonaws.com:5439/dev"]},{"cell_type":"markdown","metadata":{"id":"bmS7kKUHzi1S"},"source":["## 데이터 확인하기"]},{"cell_type":"markdown","source":["### 1. raw_data.user_session_channel  "],"metadata":{"id":"2eLQ0kzY2S28"}},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":291},"executionInfo":{"elapsed":827,"status":"ok","timestamp":1663474410961,"user":{"displayName":"DeepFlame","userId":"10126863241255225736"},"user_tz":-540},"id":"MssBrn6vULWE","outputId":"2221c731-5926-4134-c3ea-c25df29abf8c"},"outputs":[{"output_type":"stream","name":"stdout","text":[" * postgresql://guest:***@learnde.cduaw970ssvt.ap-northeast-2.redshift.amazonaws.com:5439/dev\n","10 rows affected.\n"]},{"output_type":"execute_result","data":{"text/plain":["[(1651, '0004289ee1c7b8b08c77e19878106ae3', 'Organic'),\n"," (1197, '00053f5e11d1fe4e49a221165b39abc9', 'Facebook'),\n"," (1401, '00056c20eb5a029583db75506953f1d9', 'Facebook'),\n"," (1399, '00063cb5da1826febf178b669eea3250', 'Facebook'),\n"," (1667, '000958fdaefe0dd06f5d7c4e4a5f28d1', 'Instagram'),\n"," (468, '000a3f777828d2cdbee98887561aa130', 'Facebook'),\n"," (1563, '000cb7efa8a05429dd5309b4bea2eb0c', 'Naver'),\n"," (711, '00106ac9184e7d54b570d0f0cb0c38b2', 'Organic'),\n"," (473, '0011df6282fe8cf78feeab676fbc3c27', 'Naver'),\n"," (420, '00126b47d5502dfb7d01f750ad23d813', 'Facebook')]"],"text/html":["<table>\n","    <thead>\n","        <tr>\n","            <th>userid</th>\n","            <th>sessionid</th>\n","            <th>channel</th>\n","        </tr>\n","    </thead>\n","    <tbody>\n","        <tr>\n","            <td>1651</td>\n","            <td>0004289ee1c7b8b08c77e19878106ae3</td>\n","            <td>Organic</td>\n","        </tr>\n","        <tr>\n","            <td>1197</td>\n","            <td>00053f5e11d1fe4e49a221165b39abc9</td>\n","            <td>Facebook</td>\n","        </tr>\n","        <tr>\n","            <td>1401</td>\n","            <td>00056c20eb5a029583db75506953f1d9</td>\n","            <td>Facebook</td>\n","        </tr>\n","        <tr>\n","            <td>1399</td>\n","            <td>00063cb5da1826febf178b669eea3250</td>\n","            <td>Facebook</td>\n","        </tr>\n","        <tr>\n","            <td>1667</td>\n","            <td>000958fdaefe0dd06f5d7c4e4a5f28d1</td>\n","            <td>Instagram</td>\n","        </tr>\n","        <tr>\n","            <td>468</td>\n","            <td>000a3f777828d2cdbee98887561aa130</td>\n","            <td>Facebook</td>\n","        </tr>\n","        <tr>\n","            <td>1563</td>\n","            <td>000cb7efa8a05429dd5309b4bea2eb0c</td>\n","            <td>Naver</td>\n","        </tr>\n","        <tr>\n","            <td>711</td>\n","            <td>00106ac9184e7d54b570d0f0cb0c38b2</td>\n","            <td>Organic</td>\n","        </tr>\n","        <tr>\n","            <td>473</td>\n","            <td>0011df6282fe8cf78feeab676fbc3c27</td>\n","            <td>Naver</td>\n","        </tr>\n","        <tr>\n","            <td>420</td>\n","            <td>00126b47d5502dfb7d01f750ad23d813</td>\n","            <td>Facebook</td>\n","        </tr>\n","    </tbody>\n","</table>"]},"metadata":{},"execution_count":3}],"source":["%%sql \n","SELECT *\n","FROM raw_data.user_session_channel\n","LIMIT 10;"]},{"cell_type":"code","execution_count":8,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":98},"executionInfo":{"elapsed":709,"status":"ok","timestamp":1663474564229,"user":{"displayName":"DeepFlame","userId":"10126863241255225736"},"user_tz":-540},"id":"9sHsPmBdUF2o","outputId":"95a03ea6-0e02-4a08-9cff-c4eaf0a07b0e"},"outputs":[{"output_type":"stream","name":"stdout","text":[" * postgresql://guest:***@learnde.cduaw970ssvt.ap-northeast-2.redshift.amazonaws.com:5439/dev\n","1 rows affected.\n"]},{"output_type":"execute_result","data":{"text/plain":["[(101520,)]"],"text/html":["<table>\n","    <thead>\n","        <tr>\n","            <th>count</th>\n","        </tr>\n","    </thead>\n","    <tbody>\n","        <tr>\n","            <td>101520</td>\n","        </tr>\n","    </tbody>\n","</table>"]},"metadata":{},"execution_count":8}],"source":["%%sql\n","\n","SELECT COUNT(1) -- COUNT가 복잡한 로직을 가지고 있다 (다음 강의에서 설명)\n","FROM raw_data.session_timestamp;"]},{"cell_type":"code","source":["%%sql\n","\n","SELECT column_name, data_type\n","FROM INFORMATION_SCHEMA.COLUMNS \n","WHERE table_schema='raw_data' and table_name='user_session_channel'"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":141},"id":"QDJEhB6QzwD0","executionInfo":{"status":"ok","timestamp":1663475179117,"user_tz":-540,"elapsed":419,"user":{"displayName":"DeepFlame","userId":"10126863241255225736"}},"outputId":"9e9bd8be-6962-48ab-8855-70a140826dd3"},"execution_count":38,"outputs":[{"output_type":"stream","name":"stdout","text":[" * postgresql://guest:***@learnde.cduaw970ssvt.ap-northeast-2.redshift.amazonaws.com:5439/dev\n","3 rows affected.\n"]},{"output_type":"execute_result","data":{"text/plain":["[('sessionid', 'character varying'),\n"," ('channel', 'character varying'),\n"," ('userid', 'integer')]"],"text/html":["<table>\n","    <thead>\n","        <tr>\n","            <th>column_name</th>\n","            <th>data_type</th>\n","        </tr>\n","    </thead>\n","    <tbody>\n","        <tr>\n","            <td>sessionid</td>\n","            <td>character varying</td>\n","        </tr>\n","        <tr>\n","            <td>channel</td>\n","            <td>character varying</td>\n","        </tr>\n","        <tr>\n","            <td>userid</td>\n","            <td>integer</td>\n","        </tr>\n","    </tbody>\n","</table>"]},"metadata":{},"execution_count":38}]},{"cell_type":"markdown","source":["### 2. raw_data.session_timestamp"],"metadata":{"id":"tdDJhSCp2XWg"}},{"cell_type":"code","execution_count":7,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":291},"executionInfo":{"elapsed":428,"status":"ok","timestamp":1663474443748,"user":{"displayName":"DeepFlame","userId":"10126863241255225736"},"user_tz":-540},"id":"mPtvJEvubNoV","outputId":"a9996817-b2a4-4c38-de7f-6839e88834b3"},"outputs":[{"output_type":"stream","name":"stdout","text":[" * postgresql://guest:***@learnde.cduaw970ssvt.ap-northeast-2.redshift.amazonaws.com:5439/dev\n","10 rows affected.\n"]},{"output_type":"execute_result","data":{"text/plain":["[('0002ac0d783338cfeab0b2bdbd872cda', datetime.datetime(2019, 7, 29, 12, 39, 41, 817000)),\n"," ('00053f5e11d1fe4e49a221165b39abc9', datetime.datetime(2019, 6, 24, 13, 4, 26, 370000)),\n"," ('00056c20eb5a029583db75506953f1d9', datetime.datetime(2019, 9, 26, 14, 50, 17)),\n"," ('00063cb5da1826febf178b669eea3250', datetime.datetime(2019, 10, 16, 14, 4, 42, 797000)),\n"," ('0007cda84fafdcf42f96c4f4adb7f8ce', datetime.datetime(2019, 5, 22, 8, 2, 29, 360000)),\n"," ('000c076c390a4c357313fca29e390ece', datetime.datetime(2019, 5, 2, 15, 24, 33, 963000)),\n"," ('000dd3543ac84d906eae52e7c779bb2a', datetime.datetime(2019, 8, 13, 15, 27, 51, 850000)),\n"," ('00106ac9184e7d54b570d0f0cb0c38b2', datetime.datetime(2019, 7, 25, 18, 14, 43, 37000)),\n"," ('0011df6282fe8cf78feeab676fbc3c27', datetime.datetime(2019, 11, 2, 21, 10, 41)),\n"," ('00126b47d5502dfb7d01f750ad23d813', datetime.datetime(2019, 6, 15, 15, 35, 48, 483000))]"],"text/html":["<table>\n","    <thead>\n","        <tr>\n","            <th>sessionid</th>\n","            <th>ts</th>\n","        </tr>\n","    </thead>\n","    <tbody>\n","        <tr>\n","            <td>0002ac0d783338cfeab0b2bdbd872cda</td>\n","            <td>2019-07-29 12:39:41.817000</td>\n","        </tr>\n","        <tr>\n","            <td>00053f5e11d1fe4e49a221165b39abc9</td>\n","            <td>2019-06-24 13:04:26.370000</td>\n","        </tr>\n","        <tr>\n","            <td>00056c20eb5a029583db75506953f1d9</td>\n","            <td>2019-09-26 14:50:17</td>\n","        </tr>\n","        <tr>\n","            <td>00063cb5da1826febf178b669eea3250</td>\n","            <td>2019-10-16 14:04:42.797000</td>\n","        </tr>\n","        <tr>\n","            <td>0007cda84fafdcf42f96c4f4adb7f8ce</td>\n","            <td>2019-05-22 08:02:29.360000</td>\n","        </tr>\n","        <tr>\n","            <td>000c076c390a4c357313fca29e390ece</td>\n","            <td>2019-05-02 15:24:33.963000</td>\n","        </tr>\n","        <tr>\n","            <td>000dd3543ac84d906eae52e7c779bb2a</td>\n","            <td>2019-08-13 15:27:51.850000</td>\n","        </tr>\n","        <tr>\n","            <td>00106ac9184e7d54b570d0f0cb0c38b2</td>\n","            <td>2019-07-25 18:14:43.037000</td>\n","        </tr>\n","        <tr>\n","            <td>0011df6282fe8cf78feeab676fbc3c27</td>\n","            <td>2019-11-02 21:10:41</td>\n","        </tr>\n","        <tr>\n","            <td>00126b47d5502dfb7d01f750ad23d813</td>\n","            <td>2019-06-15 15:35:48.483000</td>\n","        </tr>\n","    </tbody>\n","</table>"]},"metadata":{},"execution_count":7}],"source":["%%sql\n","\n","SELECT *\n","FROM raw_data.session_timestamp\n","LIMIT 10;"]},{"cell_type":"code","source":["%%sql\n","\n","SELECT column_name, data_type\n","FROM INFORMATION_SCHEMA.COLUMNS \n","WHERE table_schema='raw_data' and table_name='session_timestamp'"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":120},"id":"FUi6dsDE2JKa","executionInfo":{"status":"ok","timestamp":1663475254592,"user_tz":-540,"elapsed":699,"user":{"displayName":"DeepFlame","userId":"10126863241255225736"}},"outputId":"6c875fed-6927-45e4-ac15-e67eb0647de6"},"execution_count":39,"outputs":[{"output_type":"stream","name":"stdout","text":[" * postgresql://guest:***@learnde.cduaw970ssvt.ap-northeast-2.redshift.amazonaws.com:5439/dev\n","2 rows affected.\n"]},{"output_type":"execute_result","data":{"text/plain":["[('ts', 'timestamp without time zone'), ('sessionid', 'character varying')]"],"text/html":["<table>\n","    <thead>\n","        <tr>\n","            <th>column_name</th>\n","            <th>data_type</th>\n","        </tr>\n","    </thead>\n","    <tbody>\n","        <tr>\n","            <td>ts</td>\n","            <td>timestamp without time zone</td>\n","        </tr>\n","        <tr>\n","            <td>sessionid</td>\n","            <td>character varying</td>\n","        </tr>\n","    </tbody>\n","</table>"]},"metadata":{},"execution_count":39}]},{"cell_type":"code","execution_count":42,"metadata":{"id":"4P6TWcbGl2j7","colab":{"base_uri":"https://localhost:8080/","height":291},"executionInfo":{"status":"ok","timestamp":1663475326703,"user_tz":-540,"elapsed":711,"user":{"displayName":"DeepFlame","userId":"10126863241255225736"}},"outputId":"aa75ce72-48cd-449c-894b-74b9f47a2fb9"},"outputs":[{"output_type":"stream","name":"stdout","text":[" * postgresql://guest:***@learnde.cduaw970ssvt.ap-northeast-2.redshift.amazonaws.com:5439/dev\n","10 rows affected.\n"]},{"output_type":"execute_result","data":{"text/plain":["[(datetime.date(2019, 11, 30), '6309ff4befccf8ba77b16141fab763c6'),\n"," (datetime.date(2019, 11, 30), '42daed3b750cc5c6270636fddee0486d'),\n"," (datetime.date(2019, 11, 30), '398c674511e98d3e9bd40ba5bfa67af8'),\n"," (datetime.date(2019, 11, 30), '1e65c9f788d6382abc0ee60886e7fa4a'),\n"," (datetime.date(2019, 11, 30), 'ec6d363a01a8a0691d24b8556bc1fb61'),\n"," (datetime.date(2019, 11, 30), '8f48bd8292fc4540404dc9dae06175e6'),\n"," (datetime.date(2019, 11, 30), '89a76004709bb668a8aefb6306a6aed1'),\n"," (datetime.date(2019, 11, 30), '9cfaefd1e81f637fad6330ff16eb1f39'),\n"," (datetime.date(2019, 11, 30), 'bbf2f1c020c5e39734c73223784bd7b4'),\n"," (datetime.date(2019, 11, 30), 'bac82af401b714e895c9c46af11f76ea')]"],"text/html":["<table>\n","    <thead>\n","        <tr>\n","            <th>created</th>\n","            <th>sessionid</th>\n","        </tr>\n","    </thead>\n","    <tbody>\n","        <tr>\n","            <td>2019-11-30</td>\n","            <td>6309ff4befccf8ba77b16141fab763c6</td>\n","        </tr>\n","        <tr>\n","            <td>2019-11-30</td>\n","            <td>42daed3b750cc5c6270636fddee0486d</td>\n","        </tr>\n","        <tr>\n","            <td>2019-11-30</td>\n","            <td>398c674511e98d3e9bd40ba5bfa67af8</td>\n","        </tr>\n","        <tr>\n","            <td>2019-11-30</td>\n","            <td>1e65c9f788d6382abc0ee60886e7fa4a</td>\n","        </tr>\n","        <tr>\n","            <td>2019-11-30</td>\n","            <td>ec6d363a01a8a0691d24b8556bc1fb61</td>\n","        </tr>\n","        <tr>\n","            <td>2019-11-30</td>\n","            <td>8f48bd8292fc4540404dc9dae06175e6</td>\n","        </tr>\n","        <tr>\n","            <td>2019-11-30</td>\n","            <td>89a76004709bb668a8aefb6306a6aed1</td>\n","        </tr>\n","        <tr>\n","            <td>2019-11-30</td>\n","            <td>9cfaefd1e81f637fad6330ff16eb1f39</td>\n","        </tr>\n","        <tr>\n","            <td>2019-11-30</td>\n","            <td>bbf2f1c020c5e39734c73223784bd7b4</td>\n","        </tr>\n","        <tr>\n","            <td>2019-11-30</td>\n","            <td>bac82af401b714e895c9c46af11f76ea</td>\n","        </tr>\n","    </tbody>\n","</table>"]},"metadata":{},"execution_count":42}],"source":["%%sql\n","\n","SELECT DATE(ts) created, sessionID\n","FROM raw_data.session_timestamp\n","ORDER BY ts desc\n","LIMIT 10;"]},{"cell_type":"code","execution_count":46,"metadata":{"id":"ILNS7QDN63mu","colab":{"base_uri":"https://localhost:8080/","height":291},"executionInfo":{"status":"ok","timestamp":1663475351496,"user_tz":-540,"elapsed":734,"user":{"displayName":"DeepFlame","userId":"10126863241255225736"}},"outputId":"4d0c5d3e-90aa-46d1-9fc4-a18dc6412a33"},"outputs":[{"output_type":"stream","name":"stdout","text":[" * postgresql://guest:***@learnde.cduaw970ssvt.ap-northeast-2.redshift.amazonaws.com:5439/dev\n","10 rows affected.\n"]},{"output_type":"execute_result","data":{"text/plain":["[(datetime.date(2019, 10, 18), 630),\n"," (datetime.date(2019, 7, 6), 435),\n"," (datetime.date(2019, 11, 2), 556),\n"," (datetime.date(2019, 7, 23), 526),\n"," (datetime.date(2019, 8, 1), 499),\n"," (datetime.date(2019, 10, 12), 619),\n"," (datetime.date(2019, 11, 13), 671),\n"," (datetime.date(2019, 11, 6), 610),\n"," (datetime.date(2019, 9, 13), 543),\n"," (datetime.date(2019, 8, 18), 529)]"],"text/html":["<table>\n","    <thead>\n","        <tr>\n","            <th>created</th>\n","            <th>count</th>\n","        </tr>\n","    </thead>\n","    <tbody>\n","        <tr>\n","            <td>2019-10-18</td>\n","            <td>630</td>\n","        </tr>\n","        <tr>\n","            <td>2019-07-06</td>\n","            <td>435</td>\n","        </tr>\n","        <tr>\n","            <td>2019-11-02</td>\n","            <td>556</td>\n","        </tr>\n","        <tr>\n","            <td>2019-07-23</td>\n","            <td>526</td>\n","        </tr>\n","        <tr>\n","            <td>2019-08-01</td>\n","            <td>499</td>\n","        </tr>\n","        <tr>\n","            <td>2019-10-12</td>\n","            <td>619</td>\n","        </tr>\n","        <tr>\n","            <td>2019-11-13</td>\n","            <td>671</td>\n","        </tr>\n","        <tr>\n","            <td>2019-11-06</td>\n","            <td>610</td>\n","        </tr>\n","        <tr>\n","            <td>2019-09-13</td>\n","            <td>543</td>\n","        </tr>\n","        <tr>\n","            <td>2019-08-18</td>\n","            <td>529</td>\n","        </tr>\n","    </tbody>\n","</table>"]},"metadata":{},"execution_count":46}],"source":["%%sql\n","\n","SELECT DATE(ts) created, COUNT(sessionID) -- COUNT(1)\n","FROM raw_data.session_timestamp\n","GROUP BY 1 -- 첫번째 열로 그룹화한다\n","LIMIT 10;"]},{"cell_type":"code","execution_count":47,"metadata":{"id":"9T0H93a7mxHF","colab":{"base_uri":"https://localhost:8080/","height":291},"executionInfo":{"status":"ok","timestamp":1663475389027,"user_tz":-540,"elapsed":721,"user":{"displayName":"DeepFlame","userId":"10126863241255225736"}},"outputId":"0cb59070-0cda-4966-e849-216e99796717"},"outputs":[{"output_type":"stream","name":"stdout","text":[" * postgresql://guest:***@learnde.cduaw970ssvt.ap-northeast-2.redshift.amazonaws.com:5439/dev\n","10 rows affected.\n"]},{"output_type":"execute_result","data":{"text/plain":["[(datetime.date(2019, 10, 23), 678),\n"," (datetime.date(2019, 11, 13), 671),\n"," (datetime.date(2019, 11, 12), 668),\n"," (datetime.date(2019, 10, 11), 665),\n"," (datetime.date(2019, 10, 29), 660),\n"," (datetime.date(2019, 10, 21), 653),\n"," (datetime.date(2019, 11, 5), 652),\n"," (datetime.date(2019, 11, 11), 651),\n"," (datetime.date(2019, 10, 14), 648),\n"," (datetime.date(2019, 11, 7), 645)]"],"text/html":["<table>\n","    <thead>\n","        <tr>\n","            <th>created</th>\n","            <th>count</th>\n","        </tr>\n","    </thead>\n","    <tbody>\n","        <tr>\n","            <td>2019-10-23</td>\n","            <td>678</td>\n","        </tr>\n","        <tr>\n","            <td>2019-11-13</td>\n","            <td>671</td>\n","        </tr>\n","        <tr>\n","            <td>2019-11-12</td>\n","            <td>668</td>\n","        </tr>\n","        <tr>\n","            <td>2019-10-11</td>\n","            <td>665</td>\n","        </tr>\n","        <tr>\n","            <td>2019-10-29</td>\n","            <td>660</td>\n","        </tr>\n","        <tr>\n","            <td>2019-10-21</td>\n","            <td>653</td>\n","        </tr>\n","        <tr>\n","            <td>2019-11-05</td>\n","            <td>652</td>\n","        </tr>\n","        <tr>\n","            <td>2019-11-11</td>\n","            <td>651</td>\n","        </tr>\n","        <tr>\n","            <td>2019-10-14</td>\n","            <td>648</td>\n","        </tr>\n","        <tr>\n","            <td>2019-11-07</td>\n","            <td>645</td>\n","        </tr>\n","    </tbody>\n","</table>"]},"metadata":{},"execution_count":47}],"source":["%%sql\n","\n","SELECT DATE(ts) created, COUNT(sessionID)\n","FROM raw_data.session_timestamp\n","GROUP BY 1          -- 첫번째 열로 그룹화 한다\n","ORDER BY 2 DESC     -- 두번째 열로 내림차순 정렬한다\n","LIMIT 10;"]},{"cell_type":"code","execution_count":48,"metadata":{"id":"afZBLY9d7IaR","colab":{"base_uri":"https://localhost:8080/","height":291},"executionInfo":{"status":"ok","timestamp":1663475421469,"user_tz":-540,"elapsed":434,"user":{"displayName":"DeepFlame","userId":"10126863241255225736"}},"outputId":"8e0a835c-065a-4d2f-f96d-40c2c99f531e"},"outputs":[{"output_type":"stream","name":"stdout","text":[" * postgresql://guest:***@learnde.cduaw970ssvt.ap-northeast-2.redshift.amazonaws.com:5439/dev\n","10 rows affected.\n"]},{"output_type":"execute_result","data":{"text/plain":["[(datetime.date(2019, 5, 1), 147),\n"," (datetime.date(2019, 5, 2), 161),\n"," (datetime.date(2019, 5, 3), 150),\n"," (datetime.date(2019, 5, 4), 142),\n"," (datetime.date(2019, 5, 5), 144),\n"," (datetime.date(2019, 5, 6), 164),\n"," (datetime.date(2019, 5, 7), 180),\n"," (datetime.date(2019, 5, 8), 161),\n"," (datetime.date(2019, 5, 9), 169),\n"," (datetime.date(2019, 5, 10), 176)]"],"text/html":["<table>\n","    <thead>\n","        <tr>\n","            <th>date</th>\n","            <th>count</th>\n","        </tr>\n","    </thead>\n","    <tbody>\n","        <tr>\n","            <td>2019-05-01</td>\n","            <td>147</td>\n","        </tr>\n","        <tr>\n","            <td>2019-05-02</td>\n","            <td>161</td>\n","        </tr>\n","        <tr>\n","            <td>2019-05-03</td>\n","            <td>150</td>\n","        </tr>\n","        <tr>\n","            <td>2019-05-04</td>\n","            <td>142</td>\n","        </tr>\n","        <tr>\n","            <td>2019-05-05</td>\n","            <td>144</td>\n","        </tr>\n","        <tr>\n","            <td>2019-05-06</td>\n","            <td>164</td>\n","        </tr>\n","        <tr>\n","            <td>2019-05-07</td>\n","            <td>180</td>\n","        </tr>\n","        <tr>\n","            <td>2019-05-08</td>\n","            <td>161</td>\n","        </tr>\n","        <tr>\n","            <td>2019-05-09</td>\n","            <td>169</td>\n","        </tr>\n","        <tr>\n","            <td>2019-05-10</td>\n","            <td>176</td>\n","        </tr>\n","    </tbody>\n","</table>"]},"metadata":{},"execution_count":48}],"source":["%%sql\n","\n","SELECT DATE(ts) date, COUNT(sessionID)\n","FROM raw_data.session_timestamp\n","GROUP BY 1\n","ORDER BY 1\n","LIMIT 10; -- DESC"]},{"cell_type":"markdown","metadata":{"id":"7icH7h1W7RUn"},"source":["## JOIN\n","JOIN에 대해 배워보자. 일별 방문 유니크한 사용자의 수를 계산하고 싶다면? "]},{"cell_type":"code","execution_count":64,"metadata":{"id":"6D8ht2Fy7RAq","colab":{"base_uri":"https://localhost:8080/","height":291},"executionInfo":{"status":"ok","timestamp":1663477077641,"user_tz":-540,"elapsed":694,"user":{"displayName":"DeepFlame","userId":"10126863241255225736"}},"outputId":"565716a0-e8d2-43b5-a909-a8f5950bb477"},"outputs":[{"output_type":"stream","name":"stdout","text":[" * postgresql://guest:***@learnde.cduaw970ssvt.ap-northeast-2.redshift.amazonaws.com:5439/dev\n","10 rows affected.\n"]},{"output_type":"execute_result","data":{"text/plain":["[(datetime.date(2019, 5, 1), 147),\n"," (datetime.date(2019, 5, 2), 161),\n"," (datetime.date(2019, 5, 3), 150),\n"," (datetime.date(2019, 5, 4), 142),\n"," (datetime.date(2019, 5, 5), 144),\n"," (datetime.date(2019, 5, 6), 164),\n"," (datetime.date(2019, 5, 7), 180),\n"," (datetime.date(2019, 5, 8), 161),\n"," (datetime.date(2019, 5, 9), 169),\n"," (datetime.date(2019, 5, 10), 176)]"],"text/html":["<table>\n","    <thead>\n","        <tr>\n","            <th>date</th>\n","            <th>count</th>\n","        </tr>\n","    </thead>\n","    <tbody>\n","        <tr>\n","            <td>2019-05-01</td>\n","            <td>147</td>\n","        </tr>\n","        <tr>\n","            <td>2019-05-02</td>\n","            <td>161</td>\n","        </tr>\n","        <tr>\n","            <td>2019-05-03</td>\n","            <td>150</td>\n","        </tr>\n","        <tr>\n","            <td>2019-05-04</td>\n","            <td>142</td>\n","        </tr>\n","        <tr>\n","            <td>2019-05-05</td>\n","            <td>144</td>\n","        </tr>\n","        <tr>\n","            <td>2019-05-06</td>\n","            <td>164</td>\n","        </tr>\n","        <tr>\n","            <td>2019-05-07</td>\n","            <td>180</td>\n","        </tr>\n","        <tr>\n","            <td>2019-05-08</td>\n","            <td>161</td>\n","        </tr>\n","        <tr>\n","            <td>2019-05-09</td>\n","            <td>169</td>\n","        </tr>\n","        <tr>\n","            <td>2019-05-10</td>\n","            <td>176</td>\n","        </tr>\n","    </tbody>\n","</table>"]},"metadata":{},"execution_count":64}],"source":["# raw_data.user_session_channel과 raw_data.session_timestamp 테이블의 조인이 필요\n","%%sql\n","\n","SELECT DATE(st.ts) date, COUNT(usc.userID) -- 세션수 카운트와 동일. COUNT(NULL): 0, 그 이외의 모든 경우는 1을 리턴\n","FROM raw_data.session_timestamp st\n","JOIN raw_data.user_session_channel usc ON st.sessionID = usc.sessionID\n","GROUP BY 1\n","ORDER BY 1\n","LIMIT 10;"]},{"cell_type":"code","execution_count":65,"metadata":{"id":"Wak8gB2mAwYj","colab":{"base_uri":"https://localhost:8080/","height":291},"executionInfo":{"status":"ok","timestamp":1663477086592,"user_tz":-540,"elapsed":565,"user":{"displayName":"DeepFlame","userId":"10126863241255225736"}},"outputId":"2443954e-2c1e-47d2-888e-e0dbee97a895"},"outputs":[{"output_type":"stream","name":"stdout","text":[" * postgresql://guest:***@learnde.cduaw970ssvt.ap-northeast-2.redshift.amazonaws.com:5439/dev\n","10 rows affected.\n"]},{"output_type":"execute_result","data":{"text/plain":["[(datetime.date(2019, 10, 21), 549),\n"," (datetime.date(2019, 10, 14), 541),\n"," (datetime.date(2019, 10, 11), 539),\n"," (datetime.date(2019, 10, 29), 535),\n"," (datetime.date(2019, 10, 23), 535),\n"," (datetime.date(2019, 10, 10), 533),\n"," (datetime.date(2019, 10, 8), 532),\n"," (datetime.date(2019, 10, 22), 529),\n"," (datetime.date(2019, 10, 18), 528),\n"," (datetime.date(2019, 10, 15), 526)]"],"text/html":["<table>\n","    <thead>\n","        <tr>\n","            <th>date</th>\n","            <th>count</th>\n","        </tr>\n","    </thead>\n","    <tbody>\n","        <tr>\n","            <td>2019-10-21</td>\n","            <td>549</td>\n","        </tr>\n","        <tr>\n","            <td>2019-10-14</td>\n","            <td>541</td>\n","        </tr>\n","        <tr>\n","            <td>2019-10-11</td>\n","            <td>539</td>\n","        </tr>\n","        <tr>\n","            <td>2019-10-29</td>\n","            <td>535</td>\n","        </tr>\n","        <tr>\n","            <td>2019-10-23</td>\n","            <td>535</td>\n","        </tr>\n","        <tr>\n","            <td>2019-10-10</td>\n","            <td>533</td>\n","        </tr>\n","        <tr>\n","            <td>2019-10-08</td>\n","            <td>532</td>\n","        </tr>\n","        <tr>\n","            <td>2019-10-22</td>\n","            <td>529</td>\n","        </tr>\n","        <tr>\n","            <td>2019-10-18</td>\n","            <td>528</td>\n","        </tr>\n","        <tr>\n","            <td>2019-10-15</td>\n","            <td>526</td>\n","        </tr>\n","    </tbody>\n","</table>"]},"metadata":{},"execution_count":65}],"source":["# raw_data.user_session_channel과 raw_data.session_timestamp 테이블의 조인이 필요\n","%%sql\n","\n","SELECT DATE(st.ts) date, COUNT(DISTINCT usc.userID)\n","FROM raw_data.session_timestamp st\n","JOIN raw_data.user_session_channel usc ON st.sessionID = usc.sessionID\n","GROUP BY 1\n","ORDER BY 2 DESC\n","LIMIT 10;"]},{"cell_type":"code","execution_count":67,"metadata":{"id":"5ZqLeBtU7OKo","colab":{"base_uri":"https://localhost:8080/","height":205},"executionInfo":{"status":"ok","timestamp":1663477136267,"user_tz":-540,"elapsed":690,"user":{"displayName":"DeepFlame","userId":"10126863241255225736"}},"outputId":"609dcb38-51c4-47a3-eaf8-7ca2a8fc5a77"},"outputs":[{"output_type":"stream","name":"stdout","text":[" * postgresql://guest:***@learnde.cduaw970ssvt.ap-northeast-2.redshift.amazonaws.com:5439/dev\n","6 rows affected.\n"]},{"output_type":"execute_result","data":{"text/plain":["[('Facebook', 16791),\n"," ('Google', 16982),\n"," ('Instagram', 16831),\n"," ('Naver', 16921),\n"," ('Organic', 16904),\n"," ('Youtube', 17091)]"],"text/html":["<table>\n","    <thead>\n","        <tr>\n","            <th>channel</th>\n","            <th>count</th>\n","        </tr>\n","    </thead>\n","    <tbody>\n","        <tr>\n","            <td>Facebook</td>\n","            <td>16791</td>\n","        </tr>\n","        <tr>\n","            <td>Google</td>\n","            <td>16982</td>\n","        </tr>\n","        <tr>\n","            <td>Instagram</td>\n","            <td>16831</td>\n","        </tr>\n","        <tr>\n","            <td>Naver</td>\n","            <td>16921</td>\n","        </tr>\n","        <tr>\n","            <td>Organic</td>\n","            <td>16904</td>\n","        </tr>\n","        <tr>\n","            <td>Youtube</td>\n","            <td>17091</td>\n","        </tr>\n","    </tbody>\n","</table>"]},"metadata":{},"execution_count":67}],"source":["%%sql\n","\n","SELECT channel, count(st.sessionID)\n","FROM raw_data.session_timestamp st\n","JOIN raw_data.user_session_channel usc ON st.sessionID = usc.sessionID\n","GROUP BY 1\n","ORDER BY 1"]},{"cell_type":"code","execution_count":68,"metadata":{"id":"B0aDTmJ5ChIW","colab":{"base_uri":"https://localhost:8080/","height":98},"executionInfo":{"status":"ok","timestamp":1663477138020,"user_tz":-540,"elapsed":699,"user":{"displayName":"DeepFlame","userId":"10126863241255225736"}},"outputId":"d45b1ea6-a908-4ca3-9be5-344039082a46"},"outputs":[{"output_type":"stream","name":"stdout","text":[" * postgresql://guest:***@learnde.cduaw970ssvt.ap-northeast-2.redshift.amazonaws.com:5439/dev\n","1 rows affected.\n"]},{"output_type":"execute_result","data":{"text/plain":["[(67768,)]"],"text/html":["<table>\n","    <thead>\n","        <tr>\n","            <th>count</th>\n","        </tr>\n","    </thead>\n","    <tbody>\n","        <tr>\n","            <td>67768</td>\n","        </tr>\n","    </tbody>\n","</table>"]},"metadata":{},"execution_count":68}],"source":["%%sql\n","\n","SELECT COUNT(1)\n","FROM raw_data.user_session_channel \n","WHERE channel ilike '%o%'"]},{"cell_type":"markdown","source":["### MAU 세보기 ✍"],"metadata":{"id":"o3VMzxkp6l50"}},{"cell_type":"code","source":["%%sql\n","\n","SELECT TO_CHAR(st.ts, 'yyyy-mm') as yearmonth, COUNT(DISTINCT usc.userid) as mau -- userid가 중복되면 안 되기 때문에 DISTINCT 추가\n","FROM raw_data.session_timestamp st\n","JOIN raw_data.user_session_channel usc\n","ON st.sessionid=usc.sessionid\n","GROUP BY 1\n","ORDER BY 1;"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":227},"id":"83gaH3fz6ovz","executionInfo":{"status":"ok","timestamp":1663477102103,"user_tz":-540,"elapsed":440,"user":{"displayName":"DeepFlame","userId":"10126863241255225736"}},"outputId":"4afa2ea2-4ae0-4263-d41f-eaca04498119"},"execution_count":66,"outputs":[{"output_type":"stream","name":"stdout","text":[" * postgresql://guest:***@learnde.cduaw970ssvt.ap-northeast-2.redshift.amazonaws.com:5439/dev\n","7 rows affected.\n"]},{"output_type":"execute_result","data":{"text/plain":["[('2019-05', 281),\n"," ('2019-06', 459),\n"," ('2019-07', 623),\n"," ('2019-08', 662),\n"," ('2019-09', 639),\n"," ('2019-10', 763),\n"," ('2019-11', 721)]"],"text/html":["<table>\n","    <thead>\n","        <tr>\n","            <th>yearmonth</th>\n","            <th>mau</th>\n","        </tr>\n","    </thead>\n","    <tbody>\n","        <tr>\n","            <td>2019-05</td>\n","            <td>281</td>\n","        </tr>\n","        <tr>\n","            <td>2019-06</td>\n","            <td>459</td>\n","        </tr>\n","        <tr>\n","            <td>2019-07</td>\n","            <td>623</td>\n","        </tr>\n","        <tr>\n","            <td>2019-08</td>\n","            <td>662</td>\n","        </tr>\n","        <tr>\n","            <td>2019-09</td>\n","            <td>639</td>\n","        </tr>\n","        <tr>\n","            <td>2019-10</td>\n","            <td>763</td>\n","        </tr>\n","        <tr>\n","            <td>2019-11</td>\n","            <td>721</td>\n","        </tr>\n","    </tbody>\n","</table>"]},"metadata":{},"execution_count":66}]},{"cell_type":"markdown","metadata":{"id":"Kka4fmL_A6C_"},"source":["# 판다스와 연동하는 방법"]},{"cell_type":"markdown","source":["raw_data.user_session_channel"],"metadata":{"id":"4JgYsU-k92Vz"}},{"cell_type":"code","execution_count":69,"metadata":{"id":"2-us2zrscs25","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1663477154302,"user_tz":-540,"elapsed":2329,"user":{"displayName":"DeepFlame","userId":"10126863241255225736"}},"outputId":"7478f8e4-b65e-45b2-d400-da82f2ebf7bc"},"outputs":[{"output_type":"stream","name":"stdout","text":[" * postgresql://guest:***@learnde.cduaw970ssvt.ap-northeast-2.redshift.amazonaws.com:5439/dev\n","101520 rows affected.\n"]}],"source":["result = %sql SELECT * FROM raw_data.user_session_channel\n","df = result.DataFrame()"]},{"cell_type":"code","execution_count":70,"metadata":{"id":"7AmUNAj8c3fZ","colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"status":"ok","timestamp":1663477156327,"user_tz":-540,"elapsed":274,"user":{"displayName":"DeepFlame","userId":"10126863241255225736"}},"outputId":"6b335034-49ed-49e0-8498-8a30813d29c5"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["   userid                         sessionid  channel\n","0    1491  00029153d12ae1c9abe59c17ff2e0895  Organic\n","1      59  0002ac0d783338cfeab0b2bdbd872cda    Naver\n","2     117  0006246bee639c7a7b11a08e34dd3cc6  Youtube\n","3     572  0006dd05ea1e999ddaa041a7091b7b36  Organic\n","4     935  0007cda84fafdcf42f96c4f4adb7f8ce   Google"],"text/html":["\n","  <div id=\"df-4e74aa93-fd0a-4c14-82f5-99fcb84e9bf9\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>userid</th>\n","      <th>sessionid</th>\n","      <th>channel</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1491</td>\n","      <td>00029153d12ae1c9abe59c17ff2e0895</td>\n","      <td>Organic</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>59</td>\n","      <td>0002ac0d783338cfeab0b2bdbd872cda</td>\n","      <td>Naver</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>117</td>\n","      <td>0006246bee639c7a7b11a08e34dd3cc6</td>\n","      <td>Youtube</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>572</td>\n","      <td>0006dd05ea1e999ddaa041a7091b7b36</td>\n","      <td>Organic</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>935</td>\n","      <td>0007cda84fafdcf42f96c4f4adb7f8ce</td>\n","      <td>Google</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-4e74aa93-fd0a-4c14-82f5-99fcb84e9bf9')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-4e74aa93-fd0a-4c14-82f5-99fcb84e9bf9 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-4e74aa93-fd0a-4c14-82f5-99fcb84e9bf9');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":70}],"source":["df.head()"]},{"cell_type":"code","execution_count":71,"metadata":{"id":"zx3dWMB4BSo7","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1663477157486,"user_tz":-540,"elapsed":2,"user":{"displayName":"DeepFlame","userId":"10126863241255225736"}},"outputId":"39af8867-3b46-4edf-c361-a07173ffab2c"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["channel\n","Facebook     16791\n","Google       16982\n","Instagram    16831\n","Naver        16921\n","Organic      16904\n","Youtube      17091\n","dtype: int64"]},"metadata":{},"execution_count":71}],"source":["df.groupby([\"channel\"]).size()"]},{"cell_type":"code","execution_count":72,"metadata":{"id":"mpXSqwAgEV3B","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1663477158823,"user_tz":-540,"elapsed":2,"user":{"displayName":"DeepFlame","userId":"10126863241255225736"}},"outputId":"7e1b069a-1654-4a1f-aefc-de1c604a1d67"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["channel\n","Facebook     16791\n","Google       16982\n","Instagram    16831\n","Naver        16921\n","Organic      16904\n","Youtube      17091\n","Name: sessionid, dtype: int64"]},"metadata":{},"execution_count":72}],"source":["df.groupby([\"channel\"])[\"sessionid\"].count()"]},{"cell_type":"markdown","source":["raw_data.session_timestamp"],"metadata":{"id":"IAGmvJ9Y96t5"}},{"cell_type":"code","execution_count":73,"metadata":{"id":"fVdRUALFC-to","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1663477166595,"user_tz":-540,"elapsed":2429,"user":{"displayName":"DeepFlame","userId":"10126863241255225736"}},"outputId":"101d8572-13fb-4f8c-a577-bd327e7c6824"},"outputs":[{"output_type":"stream","name":"stdout","text":[" * postgresql://guest:***@learnde.cduaw970ssvt.ap-northeast-2.redshift.amazonaws.com:5439/dev\n","101520 rows affected.\n"]}],"source":["result = %sql SELECT * FROM raw_data.session_timestamp\n","df_st = result.DataFrame()"]},{"cell_type":"code","source":["df_st.dtypes"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"eaurinag-Yv0","executionInfo":{"status":"ok","timestamp":1663477331939,"user_tz":-540,"elapsed":2,"user":{"displayName":"DeepFlame","userId":"10126863241255225736"}},"outputId":"ca69ac02-76c6-4e0f-9401-a88fdbb72426"},"execution_count":80,"outputs":[{"output_type":"execute_result","data":{"text/plain":["sessionid            object\n","ts           datetime64[ns]\n","date                 object\n","dtype: object"]},"metadata":{},"execution_count":80}]},{"cell_type":"code","execution_count":74,"metadata":{"id":"kCLUOSUBBWu5","executionInfo":{"status":"ok","timestamp":1663477206892,"user_tz":-540,"elapsed":431,"user":{"displayName":"DeepFlame","userId":"10126863241255225736"}}},"outputs":[],"source":["df_st['date'] = df_st['ts'].apply(lambda x: \"%d-%02d-%02d\" % (x.year, x.month, x.day))"]},{"cell_type":"code","execution_count":81,"metadata":{"id":"SxBArtJ-DPwO","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1663477748248,"user_tz":-540,"elapsed":275,"user":{"displayName":"DeepFlame","userId":"10126863241255225736"}},"outputId":"e9c328c9-765a-4a61-e827-705213d05d84"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["date\n","2019-05-01    147\n","2019-05-02    161\n","2019-05-03    150\n","2019-05-04    142\n","2019-05-05    144\n","             ... \n","2019-11-26    633\n","2019-11-27    617\n","2019-11-28    516\n","2019-11-29    531\n","2019-11-30    562\n","Length: 214, dtype: int64"]},"metadata":{},"execution_count":81}],"source":["df_st.groupby([\"date\"]).size()  # .sort_values([\"date\"])"]},{"cell_type":"code","execution_count":82,"metadata":{"id":"izdTN1ukDU9M","colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"status":"ok","timestamp":1663477763821,"user_tz":-540,"elapsed":282,"user":{"displayName":"DeepFlame","userId":"10126863241255225736"}},"outputId":"8989e7fb-9305-4791-832c-0a9d05e2de7a"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["           date  count\n","213  2019-11-30    562\n","212  2019-11-29    531\n","211  2019-11-28    516\n","210  2019-11-27    617\n","209  2019-11-26    633\n","..          ...    ...\n","4    2019-05-05    144\n","3    2019-05-04    142\n","2    2019-05-03    150\n","1    2019-05-02    161\n","0    2019-05-01    147\n","\n","[214 rows x 2 columns]"],"text/html":["\n","  <div id=\"df-2f16c1f4-ed72-4acc-abb9-59cd8c911e97\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>date</th>\n","      <th>count</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>213</th>\n","      <td>2019-11-30</td>\n","      <td>562</td>\n","    </tr>\n","    <tr>\n","      <th>212</th>\n","      <td>2019-11-29</td>\n","      <td>531</td>\n","    </tr>\n","    <tr>\n","      <th>211</th>\n","      <td>2019-11-28</td>\n","      <td>516</td>\n","    </tr>\n","    <tr>\n","      <th>210</th>\n","      <td>2019-11-27</td>\n","      <td>617</td>\n","    </tr>\n","    <tr>\n","      <th>209</th>\n","      <td>2019-11-26</td>\n","      <td>633</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>2019-05-05</td>\n","      <td>144</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>2019-05-04</td>\n","      <td>142</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2019-05-03</td>\n","      <td>150</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2019-05-02</td>\n","      <td>161</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>2019-05-01</td>\n","      <td>147</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>214 rows × 2 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-2f16c1f4-ed72-4acc-abb9-59cd8c911e97')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-2f16c1f4-ed72-4acc-abb9-59cd8c911e97 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-2f16c1f4-ed72-4acc-abb9-59cd8c911e97');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":82}],"source":["df_st.groupby([\"date\"])[\"sessionid\"].count().reset_index(name='count').sort_values(\"date\", ascending=False)"]}],"metadata":{"colab":{"collapsed_sections":[],"provenance":[{"file_id":"13dmWBbw2a_k6e3F8VjvrHHYhOySU2Qdo","timestamp":1663474297570},{"file_id":"1plAiQ17udxzFjiYDBnyJDmmpXVCkkv77","timestamp":1663367668661},{"file_id":"1N52a3-fuH-WvS2BVGQcVscPiYEVDnVzK","timestamp":1659139495643},{"file_id":"1uqed_vTx9uLgU9cixweZFKyxojBCFlSb","timestamp":1644094705348},{"file_id":"1cm0dDa3LV6Dplfk24I7WFZGv4KhwgPDa","timestamp":1636763896380},{"file_id":"1ig4v_NMel4rD3a9MHYNCkjNgVp-izJul","timestamp":1619319928098},{"file_id":"1lmZ3Xq5FajfcRuiLdJXQsqAxPe7osRxo","timestamp":1619141412307},{"file_id":"1qSBnaKn0vrSwv_Jmywzp9PrNnFt9sqUq","timestamp":1611869389982},{"file_id":"1haXg_DwbBcdG_U1koTwObc5dmGK8o4ZM","timestamp":1611639525347},{"file_id":"1f6_2XlG_PkQ_0Rw_WwGi5PGjx3hBNlL6","timestamp":1603500012569},{"file_id":"1VJa2hi7ERonoY5PT3tIqvKAXcqwHnC-q","timestamp":1603494490229},{"file_id":"1R8htC3abnjz6j9_D_AUYBuzX1Bdcfvum","timestamp":1596239878232}],"toc_visible":true},"kernelspec":{"display_name":"Python 3","name":"python3"}},"nbformat":4,"nbformat_minor":0}